import torch


povey_win_fn= torch.tensor(
    [
        0.00000000, 0.00026515, 0.00086143, 0.00171608,
        0.00279821, 0.00408845, 0.00557293, 0.00724092,
        0.00908376, 0.01109418, 0.01326593, 0.01559356,
        0.01807216, 0.02069736, 0.02346512, 0.02637174,
        0.02941379, 0.03258803, 0.03589144, 0.03932114,
        0.04287439, 0.04654858, 0.05034120, 0.05424982,
        0.05827211, 0.06240579, 0.06664867, 0.07099859,
        0.07545345, 0.08001120, 0.08466981, 0.08942731,
        0.09428176, 0.09923124, 0.10427384, 0.10940771,
        0.11463099, 0.11994185, 0.12533848, 0.13081910,
        0.13638189, 0.14202511, 0.14774701, 0.15354580,
        0.15941978, 0.16536720, 0.17138635, 0.17747550,
        0.18363294, 0.18985698, 0.19614591, 0.20249803,
        0.20891169, 0.21538515, 0.22191676, 0.22850484,
        0.23514770, 0.24184367, 0.24859110, 0.25538829,
        0.26223361, 0.26912537, 0.27606189, 0.28304157,
        0.29006270, 0.29712364, 0.30422276, 0.31135836,
        0.31852883, 0.32573253, 0.33296776, 0.34023294,
        0.34752637, 0.35484645, 0.36219150, 0.36955994,
        0.37695011, 0.38436037, 0.39178911, 0.39923468,
        0.40669549, 0.41416988, 0.42165625, 0.42915303,
        0.43665853, 0.44417122, 0.45168945, 0.45921165,
        0.46673620, 0.47426149, 0.48178601, 0.48930812,
        0.49682623, 0.50433880, 0.51184428, 0.51934105,
        0.52682763, 0.53430241, 0.54176390, 0.54921049,
        0.55664068, 0.56405294, 0.57144576, 0.57881767,
        0.58616710, 0.59349257, 0.60079259, 0.60806572,
        0.61531037, 0.62252522, 0.62970877, 0.63685948,
        0.64397603, 0.65105689, 0.65810072, 0.66510606,
        0.67207152, 0.67899567, 0.68587720, 0.69271463,
        0.69950676, 0.70625204, 0.71294928, 0.71959710,
        0.72619420, 0.73273921, 0.73923087, 0.74566793,
        0.75204909, 0.75837308, 0.76463866, 0.77084464,
        0.77698970, 0.78307271, 0.78909242, 0.79504770,
        0.80093735, 0.80676019, 0.81251514, 0.81820107,
        0.82381684, 0.82936132, 0.83483344, 0.84023219,
        0.84555650, 0.85080528, 0.85597754, 0.86107224,
        0.86608845, 0.87102509, 0.87588131, 0.88065618,
        0.88534868, 0.88995790, 0.89448297, 0.89892310,
        0.90327728, 0.90754479, 0.91172469, 0.91581625,
        0.91981870, 0.92373115, 0.92755300, 0.93128335,
        0.93492162, 0.93846697, 0.94191885, 0.94527650,
        0.94853932, 0.95170665, 0.95477784, 0.95775241,
        0.96062970, 0.96340919, 0.96609032, 0.96867263,
        0.97115552, 0.97353864, 0.97582138, 0.97800344,
        0.98008436, 0.98206365, 0.98394102, 0.98571610,
        0.98738855, 0.98895806, 0.99042428, 0.99178690,
        0.99304581, 0.99420059, 0.99525112, 0.99619716,
        0.99703854, 0.99777514, 0.99840671, 0.99893326,
        0.99935460, 0.99967068, 0.99988145, 0.99998683,
        0.99998683, 0.99988145, 0.99967068, 0.99935460,
        0.99893326, 0.99840671, 0.99777514, 0.99703854,
        0.99619716, 0.99525112, 0.99420059, 0.99304581,
        0.99178690, 0.99042428, 0.98895806, 0.98738855,
        0.98571610, 0.98394102, 0.98206365, 0.98008436,
        0.97800344, 0.97582138, 0.97353864, 0.97115552,
        0.96867263, 0.96609032, 0.96340919, 0.96062970,
        0.95775241, 0.95477784, 0.95170665, 0.94853932,
        0.94527650, 0.94191885, 0.93846697, 0.93492162,
        0.93128335, 0.92755300, 0.92373115, 0.91981870,
        0.91581625, 0.91172469, 0.90754479, 0.90327728,
        0.89892310, 0.89448297, 0.88995790, 0.88534868,
        0.88065618, 0.87588131, 0.87102509, 0.86608845,
        0.86107224, 0.85597754, 0.85080528, 0.84555650,
        0.84023219, 0.83483344, 0.82936132, 0.82381684,
        0.81820107, 0.81251514, 0.80676019, 0.80093735,
        0.79504770, 0.78909242, 0.78307271, 0.77698970,
        0.77084464, 0.76463866, 0.75837308, 0.75204909,
        0.74566793, 0.73923087, 0.73273921, 0.72619420,
        0.71959710, 0.71294928, 0.70625204, 0.69950676,
        0.69271463, 0.68587720, 0.67899567, 0.67207152,
        0.66510606, 0.65810072, 0.65105689, 0.64397603,
        0.63685948, 0.62970877, 0.62252522, 0.61531037,
        0.60806572, 0.60079259, 0.59349257, 0.58616710,
        0.57881767, 0.57144576, 0.56405294, 0.55664068,
        0.54921049, 0.54176390, 0.53430241, 0.52682763,
        0.51934105, 0.51184428, 0.50433880, 0.49682623,
        0.48930812, 0.48178601, 0.47426149, 0.46673620,
        0.45921165, 0.45168945, 0.44417122, 0.43665853,
        0.42915303, 0.42165625, 0.41416988, 0.40669549,
        0.39923468, 0.39178911, 0.38436037, 0.37695011,
        0.36955994, 0.36219150, 0.35484645, 0.34752637,
        0.34023294, 0.33296776, 0.32573253, 0.31852883,
        0.31135836, 0.30422276, 0.29712364, 0.29006270,
        0.28304157, 0.27606189, 0.26912537, 0.26223361,
        0.25538829, 0.24859110, 0.24184367, 0.23514770,
        0.22850484, 0.22191676, 0.21538515, 0.20891169,
        0.20249803, 0.19614591, 0.18985698, 0.18363294,
        0.17747550, 0.17138635, 0.16536720, 0.15941978,
        0.15354580, 0.14774701, 0.14202511, 0.13638189,
        0.13081910, 0.12533848, 0.11994185, 0.11463099,
        0.10940771, 0.10427384, 0.09923124, 0.09428176,
        0.08942731, 0.08466981, 0.08001120, 0.07545345,
        0.07099859, 0.06664867, 0.06240579, 0.05827211,
        0.05424982, 0.05034120, 0.04654858, 0.04287439,
        0.03932114, 0.03589144, 0.03258803, 0.02941379,
        0.02637174, 0.02346512, 0.02069736, 0.01807216,
        0.01559356, 0.01326593, 0.01109418, 0.00908376,
        0.00724092, 0.00557293, 0.00408845, 0.00279821,
        0.00171608, 0.00086143, 0.00026515, 0.00000000 
    ], dtype=torch.float32
)


mel_filter = torch.tensor(
    [
        [1, 5], [4, 6], [6, 7], [10, 7],
        [13, 8], [17, 9], [21, 10], [26, 11],
        [31, 12], [37, 13], [43, 15], [50, 17],
        [58, 19], [67, 20], [77, 22], [87, 26],
        [99, 28], [113, 31], [127, 35], [144, 38],
        [162, 42], [182, 47],
        [204, 52]
    ], dtype=torch.int32
)



mel_filter_weight = torch.tensor(
    [
        0.149327, 0.552378, 0.939236, 0.688845, 0.330756, 
        0.311155, 0.669244, 0.985505, 0.652202, 0.330048, 0.0183227, 
        0.0144946, 0.347798, 0.669952, 0.981677, 0.716371, 0.423598, 0.139463, 
        0.283629, 0.576402, 0.860537, 0.863471, 0.595166, 0.334134, 0.0799906, 
        0.136529, 0.404834, 0.665866, 0.920009, 0.832381, 0.590978, 0.355478, 0.125598, 
        0.167619, 0.409022, 0.644522, 0.874402, 0.901078, 0.681672, 0.467153, 0.257309, 0.0519382, 
        0.0989221, 0.318328, 0.532847, 0.742691, 0.948062, 0.850857, 0.653887, 0.460865, 0.271635, 0.0860507, 
        0.149143, 0.346113, 0.539135, 0.728365, 0.913949, 0.903977, 0.725279, 0.549838, 0.377535, 0.20826, 0.0419086, 
        0.0960229, 0.274721, 0.450162, 0.622465, 0.79174, 0.958091, 0.878383, 0.717587, 0.559429, 0.403829, 0.250702, 0.0999715, 
        0.121617, 0.282413, 0.440571, 0.596171, 0.749298, 0.900028, 0.951564, 0.805406, 0.661437, 0.519586, 0.379793, 0.242002, 0.106154, 
        0.0484361, 0.194594, 0.338563, 0.480414, 0.620207, 0.757998, 0.893846, 0.972195, 0.840074, 0.709741, 0.581147, 0.454248, 0.328999, 0.205358, 0.083284, 
        0.0278052, 0.159926, 0.290259, 0.418853, 0.545752, 0.671001, 0.794642, 0.916716, 0.96274, 0.843684, 0.726082, 0.609898, 0.4951, 0.381654, 0.269527, 0.158692, 0.0491183, 
        0.0372599, 0.156316, 0.273918, 0.390102, 0.5049, 0.618346, 0.730473, 0.841308, 0.950882, 0.940776, 0.833639, 0.727681, 0.622877, 0.519199, 0.416626, 0.315136, 0.2147, 0.115304, 0.0169222, 
        0.0592241, 0.166361, 0.272319, 0.377123, 0.480801, 0.583374, 0.684864, 0.7853, 0.884696, 0.983078, 0.919535, 0.823124, 0.727666, 0.633148, 0.539544, 0.446845, 0.355029, 0.26408, 0.17398, 0.0847164, 
        0.0804652, 0.176876, 0.272334, 0.366852, 0.460456, 0.553155, 0.644971, 0.73592, 0.82602, 0.915284, 0.996274, 0.908633, 0.821784, 0.735712, 0.650402, 0.56584, 0.482014, 0.398912, 0.316522, 0.234829, 0.153823, 0.0734923, 
        0.00372641, 0.091367, 0.178216, 0.264288, 0.349598, 0.43416, 0.517986, 0.601088, 0.683478, 0.765171, 0.846177, 0.926508, 0.993828, 0.914816, 0.836448, 0.758712, 0.681597, 0.605095, 0.529197, 0.453892, 0.379171, 0.305025, 0.231446, 0.158425, 0.0859526, 0.014021, 
        0.00617174, 0.0851838, 0.163552, 0.241288, 0.318403, 0.394905, 0.470803, 0.546108, 0.620829, 0.694975, 0.768554, 0.841575, 0.914047, 0.985979, 0.942624, 0.871752, 0.801397, 0.731552, 0.662211, 0.593366, 0.525007, 0.457133, 0.389732, 0.3228, 0.25633, 0.190314, 0.124749, 0.0596289, 
        0.0573755, 0.128248, 0.198603, 0.268448, 0.337789, 0.406634, 0.474993, 0.542867, 0.610268, 0.6772, 0.74367, 0.809686, 0.875251, 0.940371, 0.994945, 0.93069, 0.866863, 0.803456, 0.740465, 0.67788, 0.615701, 0.553921, 0.492536, 0.431538, 0.370924, 0.31069, 0.25083, 0.191339, 0.132213, 0.0734475, 0.0150392, 
        0.00505549, 0.0693101, 0.133137, 0.196544, 0.259535, 0.32212, 0.384299, 0.446079, 0.507464, 0.568462, 0.629076, 0.68931, 0.74917, 0.808661, 0.867787, 0.926552, 0.984961, 0.956986, 0.899276, 0.841911, 0.784884, 0.728198, 0.67184, 0.615809, 0.560104, 0.50472, 0.44965, 0.394895, 0.340449, 0.286307, 0.232473, 0.178934, 0.125692, 0.0727421, 0.0200821, 
        0.0430143, 0.100724, 0.158089, 0.215116, 0.271802, 0.32816, 0.384191, 0.439896, 0.49528, 0.55035, 0.605105, 0.659551, 0.713693, 0.767527, 0.821066, 0.874308, 0.927258, 0.979918, 0.967706, 0.915617, 0.863806, 0.812275, 0.761017, 0.710028, 0.659311, 0.608856, 0.558666, 0.508737, 0.459063, 0.409647, 0.360482, 0.311567, 0.262896, 0.214473, 0.166291, 0.118348, 0.0706433, 0.0231743, 
        0.0322942, 0.0843826, 0.136194, 0.187725, 0.238983, 0.289972, 0.340689, 0.391144, 0.441334, 0.491263, 0.540937, 0.590353, 0.639518, 0.688433, 0.737104, 0.785527, 0.833709, 0.881652, 0.929357, 0.976826, 0.975939, 0.928933, 0.882155, 0.835604, 0.789276, 0.743169, 0.697284, 0.651616, 0.606162, 0.560921, 0.515896, 0.471076, 0.426464, 0.382058, 0.337858, 0.293859, 0.250058, 0.206459, 0.163053, 0.119844, 0.0768255, 0.0339988, 
        0.024061, 0.0710669, 0.117845, 0.164396, 0.210724, 0.256831, 0.302716, 0.348384, 0.393838, 0.439079, 0.484104, 0.528924, 0.573536, 0.617942, 0.662142, 0.706141, 0.749942, 0.793541, 0.836947, 0.880156, 0.923175, 0.966001, 0.991364, 0.948915, 0.906654, 0.864577, 0.822683, 0.78097, 0.739437, 0.698082, 0.656903, 0.6159, 0.575073, 0.534416, 0.493931, 0.453616, 0.413466, 0.373486, 0.33367, 0.294019, 0.254529, 0.215199, 0.176032, 0.137022, 0.0981698, 0.0594744, 0.0209334, 
        0.00863583, 0.0510847, 0.0933459, 0.135423, 0.177317, 0.21903, 0.260563, 0.301918, 0.343097, 0.3841, 0.424927, 0.465584, 0.506069, 0.546384, 0.586534, 0.626514, 0.66633, 0.705981, 0.745471, 0.784801, 0.823968, 0.862978, 0.90183, 0.940526, 0.979067, 0.982545, 0.94431, 0.906224, 0.868292, 0.830507, 0.792867, 0.755377, 0.71803, 0.680828, 0.643771, 0.606855, 0.570077, 0.533443, 0.496946, 0.460588, 0.424363, 0.388277, 0.352326, 0.316507, 0.280823, 0.245269, 0.209846, 0.174553, 0.139388, 0.104352, 0.0694436, 0.0346582
    ], dtype=torch.float32
)

mel_scale = torch.zeros((23, 256), dtype=torch.float32)
offset = 0
for i, d in enumerate(mel_filter):
    mel_scale[i][d[0]:d[0]+d[1]] = mel_filter_weight[offset:offset+d[1]]
    offset += d[1]
for i in range(23):
    print(mel_scale[i])
